%% CMWR PLOTS
clear all
close all

x = [10 20 40 80 ];
%% Unsaturated porous media
%% Monolithic
n_N_1 = [20 20 20 20];
t_N_1 = [1.07 1.35 1.82 4.17];
c_N_1 = [511.0045 2.2933e+03 9.4458e+03 3.8371e+04];
% dx = 40 
n_N_1_t = [20 40 80 160];
c_N_1_t = [9.4458e+03 4.7275e+03 2.3677e+03 1.1876e+03];

% L_1 =.15 L_2=.005
n_L_1 = [277 300 363 510];
t_L_1 = [4.01 5.11 9.39 58.16];
c_L_1 = [183.4223 812.5650 3.3450e+03 1.3585e+04];
% dx = 40 
n_L_1_t = [363 570 1048 1914];
c_L_1_t = [3.3450e+03 1.7540e+03 898.9759 455.3332];

% Picard
n_P_1 = [100 110 120 130];
t_P_1 = [2.28 2.85 4.87 17.68];
c_P_1 = [326.8280 1.4667e+03 6.0380e+03 2.4522e+04];
% dx = 40 
n_P_1_t = [120 220 400 640];
c_P_1_t = [6.0380e+03 3.0216e+03 1.5132e+03 758.9936];

%% Sequential classical
n_N_2 = [40 40 40 40];
t_N_2 = [1.98 2.08 2.39 3.89];
c_N_2_p = [333.4035 1.5040e+03 6.1312e+03 2.4774e+04];
c_N_2_c = [5.9916 6.2079 6.3234 6.3816];
% dx = 40 
n_N_2_t = [40 80 160 320];
c_N_2_t_p = [6.1312e+03 3.2581e+03 1.7024e+03 870.8016];
c_N_2_t_c = [6.3234 6.3234 6.3234 6.3234 ];

% L_1 =.15 L_2=.005
n_L_2 = [540 650 750 850];
t_L_2 = [8.16 10.20 15.37 40.59];
c_L_2_p = [177.4742 796.5765 3.2584e+03 1.3191e+04];
c_L_2_c = [2.1356 2.1839 2.2092 2.2220];
% dx = 40 
n_L_2_t = [750 1300 2160 3520];
c_L_2_t_p = [3.2584e+03 1.7026e+03 870.2808 440.6573];
c_L_2_t_c = [2.2092 2.2092 2.2092 2.2092];

% Picard
n_P_2 = [40 40 40 40];
t_P_2 = [1.97 1.82 2.32 3.77];
c_P_2_p = [177.4610 796.5170 3.2581e+03 1.3190e+04];
c_P_2_c = [5.9916 6.2079 6.3234 6.3816];
% dx = 40 
n_P_2_t = [40 80 160 320];
c_P_2_t_p = [3.2581e+03 1.7025e+03 870.8263 440.8018];
c_P_2_t_c = [6.3234 6.3234 6.3234 6.3234];

%% Sequential alternative
n_N_3 = [20 20 20 20];
t_N_3 = [2.22 2.28 3.17 5.08];
c_N_3_p = [333.4019 1.5040e+03 6.1312e+03 2.4774e+04];
c_N_3_c = [5.9916 6.2079 6.3234 6.3817];
% dx = 40 
n_N_3_t = [20 40 80 160];
c_N_3_t_p = [6.1312e+03 3.2580e+03 1.7024e+03 870.8010];
c_N_3_t_c = [6.3234 6.3234 6.3234 6.3234];

% L scheme
n_L_3 = [264 316 368 421];
t_L_3 = [12.52 16.65 23.28 54.85];
c_L_3_p = [177.4725 796.5755 3.2584e+03 1.3191e+04];
c_L_3_c = [2.1356 2.1839 2.2092 2.220];
% dx = 40 
n_L_3_t = [368 633 1050 1700];
c_L_3_t_p = [3.2584e+03 1.7026e+03 870.8979 440.8161];
c_L_3_t_c = [2.2092 2.2092 2.2092 2.2092];

% Picard
n_P_3 = [20 20 20 20];
t_P_3 = [2.24 2.46 3.53 5.95];
c_P_3_p = [177.4601 796.5129 3.2581e+03 1.3190e+04];
c_P_3_c = [5.9916 6.2079 6.3234 6.3817];
% dx = 40 
n_P_3_t = [20 40 80 160];
c_P_3_t_p = [3.2581e+03 1.7025e+03 870.8251 440.8015];
c_P_3_t_c = [6.3234 6.3234 6.3234 6.3234 6.3234];

%{
% condition numbers
figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,log(c_L_1),'--o', x,log(c_N_1),'--o', x,log(c_P_1),'--o',...
    x,log(c_L_2_p),'--+',x,log(c_L_2_c),'--+',x,log(c_N_2_p),'--+',x,log(c_N_2_c),'--+',...
    x,log(c_P_2_p),'--+',x,log(c_P_2_c),'--+',...
    x,log(c_L_3_p),'--*', x,log(c_L_3_c),'--*', x,log(c_N_3_p),'--*', x,log(c_N_3_c),'--*',...
    x,log(c_P_3_p),'--*',x,log(c_P_3_c),'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel('Logarithm of condition numbers', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Condition numbers (fixed dt=1/10)'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'L-Scheme p eq. (Sequential)','L-Scheme c eq. (Sequential)',...
    'Newton p eq. (Sequential)','Newton c eq. (Sequential)', ...
    'Picard p eq. (Sequential)', 'Picard c eq. (Sequential)',...
    'L-Scheme p eq. (Alternative Seq)', 'L-Scheme c eq. (Alternative Seq)',...
    'Newton p eq. (Alternative Seq)','Newton c eq. (Alternative Seq)',...
    'Picard p eq. (Alternative Seq)','Picard c eq. (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')
%print -depsc2 ArticleDxUnsat.eps


%
figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,(n_L_1),'--o', x,(n_N_1),'--o', x,(n_P_1),'--o',...
    x,(n_L_2),'--+',x,(n_N_2),'--+', x,(n_P_2),'--+',...
    x,(n_L_3),'--*',x,(n_N_3),'--*', x,(n_P_3),'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel('Log Number Iterations', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Total number of iterations (fixed dt=1/10)'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'L-Scheme (Sequential)', 'Newton (Sequential)', 'Picard (Sequential)',...
    'L-Scheme (Alternative Seq)', 'Newton (Alternative Seq)', 'Picard (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')
%print -depsc2 ArticleDxUnsat.eps


figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,log(n_L_1),'--o', x,log(n_N_1),'--o', x,log(n_P_1),'--o',...
   x,log(n_N_2),'--+', x,log(n_P_2),'--+',...
    x,log(n_N_3),'--*', x,log(n_P_3),'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel('Log Number Iterations', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Zoomed in iterations (fixed dt=1/10)'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'Newton (Sequential)', 'Picard (Sequential)',...
    'Newton (Alternative Seq)', 'Picard (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')
%print -depsc2 ArticleDtUnsat.eps



figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,log(n_L_1_t),'--o', x,log(n_N_1_t),'--o', x,log(n_P_1_t),'--o',...
   x,log(n_N_2_t),'--+', x,log(n_P_2_t),'--+',...
    x,log(n_N_3_t),'--*', x,log(n_P_3_t),'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel(' Number Iterations', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Total number of iterations (fixed dx=1/40)'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'Newton (Sequential)', 'Picard (Sequential)',...
    'Newton (Alternative Seq)', 'Picard (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')
print -depsc2 logArticleDtUnsat.eps

figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,(t_L_1),'--o', x,(t_N_1),'--o', x,(t_P_1),'--o',...
    x,(t_L_2),'--+',x,(t_N_2),'--+', x,(t_P_2),'--+',...
    x,(t_L_3),'--*',x,(t_N_3),'--*', x,(t_P_3),'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel(' computational times', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Computational times (fixed dt=1/10)'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'L-Scheme (Sequential)', 'Newton (Sequential)', 'Picard (Sequential)',...
    'L-Scheme (Alternative Seq)', 'Newton (Alternative Seq)', 'Picard (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')
%print -depsc2 cmwr2018.eps
%}
%% Variably saturated
%
%
%
clear all
x = [10 20 40 80 ];
z = [10 20];
t = [10 20 40];
w = [10]; 
%% Monolithic 
% Newton only large mesh or smaller tiome steps
n_N_1 = [28 ];
t_N_1 = [1.37 ];
c_N_1 = [2.2753e+11 1.2345e+12 4.5159e+12 1.7232e+13];
% dx = 40 
n_N_1_t = [];
c_N_1_t = [4.5159e+12 4.5194e+12];
%dx=40 dt=40 it works n = 80 c = 4.5265e+12 t = 5.87
%dx=80 dt=40 it works n = 160 c = 4.5406e+12 t = 10.76

% L_1 =.15 L_2=.005
n_L_1 = [175 314 352 408];
t_L_1 = [4.50 5.50 10.31 44.08];
c_L_1 = [247.8672 1.0576e+03 4.2256e+03 1.6902e+04];
% dx = 40 
n_L_1_t = [352 627 1100 1900];
c_L_1_t = [4.2256e+03 2.2518e+03 1.1624e+03 589.7690];

% Picard not working
n_P_1 = [];
t_P_1 = [];
c_P_1 = [4.5478e+11 2.4690e+12 9.0318e+12 3.4465e+13];
% dx = 40 
n_P_1_t = [];
c_P_1_t = [2.4690e+12 9.0388e+12 9.0529e+12 9.0811e+12];

%% Sequential classical
% Newton
n_N_2 = [50 ];
t_N_2 = [2.22 ];
c_N_2_p = [5.7734e+09 4.6521e+09 5.2321e+09 5.5219e+09];
c_N_2_c = [1.1251 1.0126 1.0124 1.0123];
% dx = 40 
n_N_2_t = [];
c_N_2_t_p = [5.2321e+09 1.0442e+10 2.1747e+10];
c_N_2_t_c = [1.0124 1.0062 1.1325 ];
%dx=40 dt=40 it works n = 200 c_p = 2.1747e+10 c_c = 1.1325 t = 8.57
%dx=80 dt=40 it works n = 400 c_p = 4.3494e+10 c_c = 1.1325 t = 16.10
 
% L_1 =.15 L_2=.005
n_L_2 = [440 650 750 910];
t_L_2 = [8.62 9.92 16.50 48.52];
c_L_2_p = [239.2940 1.0432e+03 4.1291e+03 1.6437e+04];
c_L_2_c = [1.3314 1.3338 1.3328 1.3323];
% dx = 40 
n_L_2_t = [750 1300 2160 3520];
c_L_2_t_p = [4.1291e+03 2.1862e+03 1.1258e+03 570.6119];
c_L_2_t_c = [1.3328 1.3328 1.3328 1.3328];

% Picard
n_P_2 = [50 ];
t_P_2 = [2.21 ];
c_P_2_p = [5.7735e+09 4.6521e+09 5.2321e+09 5.5219e+09];
c_P_2_c = [1.1251 1.0126 1.0124 1.0123];
% dx = 40 
n_P_2_t = [];
c_P_2_t_p = [5.2321e+09 1.0442e+10];
c_P_2_t_c = [1.0124 1.0062];
%dx=40 dt=40 it works n = 200 c_p = 2.1748e+10 c_c = 1.1325 t = 8.14
%dx=80 dt=40 it works n = 400 c_p = 4.3494e+10 c_c = 1.1325 t = 16.10

%% Sequential alternative
n_N_3 = [];
t_N_3 = [];
c_N_3_p = [5.5783e+09 4.6521e+09 5.2321e+09 5.5219e+09];
c_N_3_c = [1.0117 1.0126 1.0124 1.0123];
% dx = 40 
n_N_3_t = [];
c_N_3_t_p = [5.2321e+09 1.0441e+10 2.0860e+10 4.1721e+10];
c_N_3_t_c = [1.0124 1.0062 1.0031 1.0031];

% L scheme
n_L_3 = [264 316 368 421];
t_L_3 = [14.17 18.04 23.79 54.30];
c_L_3_p = [239.8408 1.0432e+03 4.1291e+03 1.6437e+04];
c_L_3_c = [1.3314 1.3338 1.3328 1.3323];
% dx = 40 
n_L_3_t = [368 633 1057 1700];
c_L_3_t_p = [4.1291e+03 2.1890e+03 1.1266e+03 571.0523];
c_L_3_t_c = [1.3328 1.3328 1.3328 1.3328];

% Picard
n_P_3 = [];
t_P_3 = [];
c_P_3_p = [5.5783e+09 4.6521e+09 5.2321e+09 5.5219e+09];
c_P_3_c = [1.0117 1.0126 1.0124 1.0123];
% dx = 40 
n_P_3_t = [];
c_P_3_t_p = [5.2321e+09 1.0442e+10 2.0860e+10 4.1698e+10];
c_P_3_t_c = [1.0124 1.0062 1.0031 1.0015];

figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,n_L_1_t,'--o',  ...
    x,n_L_2_t,'--+', ...
    x,n_L_3_t,'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel('Number Iterations', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Total number of iterations (fixed dt=1/10)'),...
    legend({'L-Scheme (FIM)',  ...
    'L-Scheme (Sequential)', ...
    'L-Scheme (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')
print -depsc2 ArticleDtVarSat.eps


figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,n_L_1,'--o', x,n_N_1,'--o', x,n_P_1,'--o',...
   x,n_N_2,'--+', x,n_P_2,'--+',...
    x,n_N_3,'--*', x,n_P_3,'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel('Number Iterations', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Zoomed in iterations (fixed dt=1/10)'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'Newton (Sequential)', 'Picard (Sequential)',...
    'Newton (Alternative Seq)', 'Picard (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')
%print -depsc2 cmwr2018.eps



figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,n_L_1_t,'--o', x,n_N_1_t,'--o', x,n_P_1_t,'--o',...
   x,n_N_2_t,'--+', x,n_P_2_t,'--+',...
    x,n_N_3_t,'--*', x,n_P_3_t,'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel('Number Iterations', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Total number of iterations (fixed dx=1/40)'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'Newton (Sequential)', 'Picard (Sequential)',...
    'Newton (Alternative Seq)', 'Picard (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')
%print -depsc2 cmwr2018.eps

figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,t_L_1,'--o', x,t_N_1,'--o', x,t_P_1,'--o',...
    x,t_L_2,'--+',x,t_N_2,'--+', x,t_P_2,'--+',...
    x,t_L_3,'--*',x,t_N_3,'--*', x,t_P_3,'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel('Number Iterations', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Computational times (fixed dt=1/10)'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'L-Scheme (Sequential)', 'Newton (Sequential)', 'Picard (Sequential)',...
    'L-Scheme (Alternative Seq)', 'Newton (Alternative Seq)', 'Picard (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')














%{
%print -depsc2 zoomcmwr2018.eps
figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,c_L_1,'--o', x,c_N_1,'--o', x,c_P_1,'--o',...
   x,c_N_2_p,'--+', x,c_P_2_p,'--+',...
    x,c_N_3_p,'--*', x,c_P_3_p,'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel('Number Iterations', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Condition numbers pressure'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'Newton pressure (Sequential)', 'Newton concentration (Sequential)', 'Picard pressure (Sequential)',...
    'Picard concentration (Sequential)', 'Newton pressure (Alternative Seq)', ...
    'Newton concentration (Alternative Seq)','Picard pressure (Alternative Seq)','Picard concentration (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')

figure('Units','inches',...
'PaperPositionMode','auto');
grid on, plot(x,c_L_1,'--o', x,c_N_1,'--o', x,c_P_1,'--o',...
    x,c_N_2_c,'--+', x,c_P_2_c,'--+',...
    x,c_N_3_c,'--*',  x,c_P_3_c,'--*'),...
    xlabel('1/h', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times'), ylabel('Number Iterations', 'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times') ,...
title('Condition numbers concentration'),...
    legend({'L-Scheme (FIM)', 'Newton (FIM)', 'Picard (FIM)',...
    'Newton pressure (Sequential)', 'Newton concentration (Sequential)', 'Picard pressure (Sequential)',...
    'Picard concentration (Sequential)', 'Newton pressure (Alternative Seq)', ...
    'Newton concentration (Alternative Seq)','Picard pressure (Alternative Seq)','Picard concentration (Alternative Seq)'},...
      'FontUnits','points',...
'interpreter','latex',...
'FontSize',11,...
'FontName','Times',...
    'Location','NorthWest');
set(gca,...
'Units','normalized',...
'FontUnits','points',...
'FontWeight','normal',...
'FontSize',12,...
'FontName','Times')
%}
%}